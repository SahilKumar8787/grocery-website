<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Products - Fresh Mart</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
    .products-hero {
      background: url('images/grocery-banner.png') no-repeat center center/cover;
      color: #fff;
      text-align: center;
      padding: 50px 20px 30px 20px;
      border-radius: 0 0 30px 30px;
      box-shadow: 0 4px 20px rgba(76,175,80,0.10);
      margin-bottom: 0;
    }
    .products-hero h1 {
      font-size: 2.5rem;
      background: rgba(0,0,0,0.4);
      display: inline-block;
      padding: 10px 30px;
      border-radius: 10px;
      letter-spacing: 2px;
      margin-bottom: 10px;
    }
    .products-hero p {
      font-size: 1.1rem;
      background: rgba(0,0,0,0.3);
      display: inline-block;
      padding: 8px 20px;
      border-radius: 8px;
      margin-top: 10px;
    }
    .products { display: grid; grid-template-columns: repeat(auto-fit,minmax(220px,1fr)); gap: 24px; max-width:1100px; margin:auto; padding:28px; }
    .product-card { background:#fff;padding:18px;border-radius:12px;text-align:center;box-shadow:0 2px 12px rgba(0,0,0,0.06); }
    .product-card img{ width:140px;height:140px;object-fit:cover;border-radius:10px; }
    .product-actions{ margin-top:12px; display:flex; justify-content:center; gap:10px; flex-wrap:wrap;}
    .view-btn, .add-cart-btn { cursor:pointer; padding:8px 16px; border-radius:8px; text-decoration:none; color:#fff; font-weight:600; border:none; }
    .view-btn{ background: linear-gradient(90deg,#4caf50 60%,#b9d86a 100%); }
    .add-cart-btn{ background: linear-gradient(90deg,#ff9800 60%,#fcb045 100%); }
    @media (max-width:600px){ .products{ padding:12px; gap:14px } }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav>
    <div class="logo">Fresh Mart</div>
    <div>
      <a href="index.html">Home</a>
      <a href="products.html">Products</a>
      <a href="about.html">About</a>
      <a href="contact.html">Contact</a>
      <span class="user-nav"></span>
      <a href="cart.html">Cart <span class="cart-count">0</span></a>
    </div>
  </nav>

  <!-- Products Hero Banner -->
  <section class="products-hero">
    <h1>Our Best Products</h1>
    <p>Discover fresh, organic groceries handpicked for you!</p>
  </section>

  <!-- Products Listing -->
  <section class="products" id="products-container">
    <!-- products will be rendered by js/script.js on DOMContentLoaded -->
  </section>

  <footer>
    <p>&copy; 2025 Fresh Mart</p>
  </footer>

  <script src="js/script.js"></script>
  <script>
    // Render products on products page using the products array from script.js
    document.addEventListener('DOMContentLoaded', function() {
      const container = document.getElementById('products-container');
      if (!container || typeof products === 'undefined') return;

      container.innerHTML = products.map(p => `
        <div class="product-card">
          <img src="${p.image}" alt="${p.name}">
          <h3 style="color:#4caf50;margin:10px 0 6px">${p.name}</h3>
          <p style="color:#ff9800;font-weight:600">â‚¹ ${p.price} </p>
          <div class="product-actions">
            <a class="view-btn" href="products-details.html?id=${p.id}"><i class="fas fa-eye"></i> View</a>
            <button class="add-cart-btn" onclick="addToCartFromList(${p.id})"><i class="fas fa-cart-plus"></i> Add to Cart</button>
          </div>
        </div>
      `).join('');
    });

    // helper: add product by id with qty=1 (uses localStorage and updateCartCount from script.js)
    function addToCartFromList(id) {
      const prod = products.find(p => p.id === id);
      if (!prod) return alert('Product not found');
      // call shared logic if available, else manipulate cart directly
      if (typeof isLoggedIn === 'function' && !isLoggedIn()) {
        alert('Please login first to add items to cart!');
        window.location.href = 'login.html';
        return;
      }
      let cart = JSON.parse(localStorage.getItem('cart')) || [];
      const existing = cart.find(i => i.name === prod.name);
      if (existing) existing.qty += 1;
      else cart.push({ name: prod.name, price: prod.price, qty: 1 });
      localStorage.setItem('cart', JSON.stringify(cart));
      if (typeof updateCartCount === 'function') updateCartCount();
      alert(`${prod.name} added to cart`);
    }
  </script>
</body>
</html>
